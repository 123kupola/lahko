---
import type { HTMLAttributes } from 'astro/types';
import { getLangFromUrl } from '../utils/i18n';

type Props = HTMLAttributes<'a'>;

const { href, class: className, ...props } = Astro.props;
const lang = getLangFromUrl(Astro.url);

const currentPathname = Astro.url.pathname.replace(/\/$/, ''); // Remove trailing slash from current pathname
const linkHref = href.replace(/\/$/, ''); // Remove trailing slash from link href

let isActive = false;

if (lang === 'si') {
  // For default language, compare directly
  isActive = linkHref === currentPathname;
} else {
  // For other languages, compare after removing the language prefix from current pathname
  const pathnameWithoutLang = currentPathname.startsWith(`/${lang}`)
    ? currentPathname.substring(`/${lang}`.length)
    : currentPathname;
  isActive = linkHref === pathnameWithoutLang;
}
---

<a href={href} class:list={[className, { active: isActive }]} {...props}>
	<slot />
</a>
<style>
	a {
		display: inline-block;
		text-decoration: none;
	}
	a.active {
		font-weight: bolder;
		text-decoration: underline;
	}
</style>
